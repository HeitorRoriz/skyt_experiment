{
  "$schema": "../../schema/restriction.schema.json",
  "id": "nasa_power_of_10",
  "name": "NASA/JPL Power of 10 Rules",
  "version": "1.0.0",
  "source": "preset",
  "authority": "NASA/JPL Laboratory for Reliable Software",
  "reference_url": "https://spinroot.com/gerard/pdf/P10.pdf",
  "description": "Ten rules for writing safety-critical code, developed by NASA/JPL for mission-critical software. These rules restrict language features to enable static analysis and verification.",
  "applicable_languages": ["c", "cpp", "python"],
  "dal_levels": ["A", "B"],
  "rules": [
    {
      "id": "P10-R1",
      "name": "Simple Control Flow",
      "description": "Restrict all code to very simple control flow constructs. Do not use goto statements, setjmp or longjmp constructs, or direct or indirect recursion.",
      "rationale": "Simpler control flow translates into stronger capabilities for analysis and often results in improved code clarity.",
      "severity": "mandatory",
      "category": "control_flow",
      "detector": "ast_pattern",
      "pattern": {
        "forbidden": ["goto", "setjmp", "longjmp", "recursion"],
        "ast_node_types": ["Goto", "Call"]
      },
      "references": ["MISRA-C:2012 Rule 15.1", "CERT C MSC20-C"]
    },
    {
      "id": "P10-R2",
      "name": "Fixed Loop Bounds",
      "description": "All loops must have a fixed upper-bound. It must be trivially possible for a checking tool to prove statically that a preset upper-bound on the number of iterations of a loop cannot be exceeded.",
      "rationale": "The absence of recursion and the presence of loop bounds prevents runaway code.",
      "severity": "mandatory",
      "category": "control_flow",
      "detector": "static_analysis",
      "pattern": {
        "required": ["loop_bound_expression"],
        "ast_node_types": ["For", "While"]
      },
      "references": ["MISRA-C:2012 Rule 14.2"]
    },
    {
      "id": "P10-R3",
      "name": "No Dynamic Memory After Init",
      "description": "Do not use dynamic memory allocation after initialization. Memory allocation is allowed during program initialization, but prohibited during normal operation.",
      "rationale": "Eliminates memory leaks, heap fragmentation, and out-of-memory conditions during critical operation.",
      "severity": "mandatory",
      "category": "memory",
      "detector": "ast_pattern",
      "pattern": {
        "forbidden": ["malloc", "calloc", "realloc", "free", "new", "delete"],
        "ast_node_types": ["Call"]
      },
      "exceptions": ["Allowed during initialization phase only"],
      "references": ["MISRA-C:2012 Rule 21.3", "JPL Institutional Coding Standard ยง2.5"]
    },
    {
      "id": "P10-R4",
      "name": "Short Functions",
      "description": "No function should be longer than what can be printed on a single sheet of paper in a standard reference format with one line per statement and one line per declaration. Typically, this means no more than about 60 lines of code per function.",
      "rationale": "Each function should be a logical unit that is understandable and verifiable as a unit.",
      "severity": "required",
      "category": "structure",
      "detector": "static_analysis",
      "pattern": {
        "max_function_lines": 60,
        "max_statements": 60
      },
      "references": ["MISRA-C:2012 Dir 4.4"]
    },
    {
      "id": "P10-R5",
      "name": "Low Assertion Density",
      "description": "The assertion density of the code should average to a minimum of two assertions per function. Assertions are used to check for anomalous conditions that should never happen in real-life executions.",
      "rationale": "Assertions serve as in-code documentation and aid in verification. They must be side-effect free.",
      "severity": "required",
      "category": "defensive",
      "detector": "static_analysis",
      "pattern": {
        "required": ["assert"],
        "min_assertions_per_function": 2
      },
      "references": ["JPL Institutional Coding Standard ยง2.4"]
    },
    {
      "id": "P10-R6",
      "name": "Minimal Variable Scope",
      "description": "Data objects must be declared at the smallest possible level of scope. No global variables unless absolutely necessary.",
      "rationale": "Prevents unintended side effects and makes code easier to analyze.",
      "severity": "required",
      "category": "declarations",
      "detector": "ast_pattern",
      "pattern": {
        "forbidden": ["global_variable"],
        "ast_node_types": ["Global", "Name"]
      },
      "references": ["MISRA-C:2012 Rule 8.9"]
    },
    {
      "id": "P10-R7",
      "name": "Check Return Values",
      "description": "The return value of non-void functions must be checked by each calling function, and the validity of parameters must be checked inside each function.",
      "rationale": "Ensures all error conditions are properly handled.",
      "severity": "mandatory",
      "category": "defensive",
      "detector": "static_analysis",
      "pattern": {
        "required": ["return_value_check", "parameter_validation"]
      },
      "references": ["MISRA-C:2012 Rule 17.7", "CERT C ERR33-C"]
    },
    {
      "id": "P10-R8",
      "name": "Limited Preprocessor Use",
      "description": "The use of the preprocessor must be limited to the inclusion of header files and simple macro definitions. Token pasting, variable argument lists (ellipses), and recursive macro calls are not allowed.",
      "rationale": "Complex preprocessor usage obscures code and breaks static analysis tools.",
      "severity": "mandatory",
      "category": "preprocessor",
      "detector": "ast_pattern",
      "pattern": {
        "forbidden": ["token_pasting", "variadic_macro", "recursive_macro"],
        "allowed": ["include", "define_constant", "define_simple_macro"]
      },
      "references": ["MISRA-C:2012 Dir 4.9"]
    },
    {
      "id": "P10-R9",
      "name": "Limited Pointer Use",
      "description": "The use of pointers should be restricted. Specifically, no more than one level of dereferencing is allowed. Pointer dereference operations may not be hidden in macro definitions or inside typedef declarations.",
      "rationale": "Limits complexity and enables static analysis of memory access patterns.",
      "severity": "mandatory",
      "category": "pointers",
      "detector": "static_analysis",
      "pattern": {
        "max_pointer_depth": 1,
        "forbidden": ["hidden_pointer_dereference"]
      },
      "references": ["MISRA-C:2012 Rule 18.4"]
    },
    {
      "id": "P10-R10",
      "name": "Compile with All Warnings",
      "description": "All code must be compiled, from the first day of development, with all compiler warnings enabled at the compiler's most pedantic setting. All code must compile with these settings without any warnings.",
      "rationale": "Compiler warnings catch many potential issues. Zero-warning policy ensures clean, analyzable code.",
      "severity": "mandatory",
      "category": "build",
      "detector": "custom",
      "pattern": {
        "required": ["pedantic_warnings", "werror"]
      },
      "references": ["MISRA-C:2012 Dir 4.1", "JPL Institutional Coding Standard ยง1.1"]
    }
  ],
  "audit_metadata": {
    "last_reviewed": "2025-01-01",
    "reviewed_by": "skyt_team",
    "certification_mapping": {
      "DO-178C": ["Table A-5 Obj 1", "Table A-5 Obj 2", "Table A-5 Obj 3"],
      "IEC-61508": ["Part 3, Table A.3"],
      "ISO-26262": ["Part 6, Table 1"]
    }
  },
  "metadata": {
    "author": "NASA/JPL Laboratory for Reliable Software",
    "created_at": "2006-01-01T00:00:00Z",
    "updated_at": "2025-11-25T00:00:00Z",
    "tags": ["safety-critical", "aerospace", "embedded", "c", "cpp"]
  }
}
